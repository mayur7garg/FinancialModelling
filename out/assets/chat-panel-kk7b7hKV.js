import{s as ne}from"./chunk-DZLz74EQ.js";import{c as $e,l as Xt,s as qt,u as Vt}from"./jotai-C7U7c6dd.js";import{t as Bt}from"./react-cj45iF1i.js";import{J as Jt,Mt as $t,Ot as Qt,w as Zt}from"./cells-D2eha_-B.js";import"./react-dom-BjyRIiB0.js";import{C as Qe,E as Gt,F as Kt,z as st}from"./zod-U2NFpcFA.js";import{t as Ie}from"./compiler-runtime-bbSa6V1W.js";import"./_Uint8Array-D5Z9rM2X.js";import"./isSymbol-xTSywenE.js";import"./_arrayMap-DQI2GUNb.js";import"./toString-CBnct2wx.js";import"./toNumber-CTOPJrpu.js";import"./toInteger-Bor4StOs.js";import"./isArrayLikeObject-DKyJYtr8.js";import"./_getTag-CVRrQL_Q.js";import"./_baseIsEqual-CVFfFJm2.js";import"./_toKey-16owuO_q.js";import"./memoize-DhF8x4Aa.js";import"./get-BUGWIXZE.js";import"./merge-Dvc5opZF.js";import"./_baseSlice-BWZ0PeaJ.js";import"./upperFirst-CBQfDRod.js";import"./_hasUnicode-3DIK_jNi.js";import"./capitalize-CBqvgOfA.js";import"./_arrayReduce-DV4IVFuG.js";import"./startCase-RfubwhHM.js";import"./_baseProperty-c4IQJQis.js";import"./now-BXqTLlmI.js";import"./debounce-BUM2losY.js";import{t as at}from"./isEmpty-B-9PYDiJ.js";import"./tooltip-CJwdMp1K.js";import"./range-ZclXTdAh.js";import"./client-Iy_pMvsj.js";import{u as B}from"./hotkeys-jCLisiwR.js";import"./invariant-D5a0EE05.js";import{n as nt,r as er}from"./utils-GFT-p9ER.js";import"./constants-CEISdYm1.js";import{a as tr}from"./config-CULm_ZjE.js";import"./api-DvkfrUs5.js";import"./ErrorBoundary-Bu1xrDr8.js";import{o as ce}from"./useEventListener-DVwjxFkt.js";import{t as rr}from"./jsx-runtime-DmpivWpf.js";import"./clsx-BlAkgCmw.js";import{t as V}from"./cn-BaXqCYqP.js";import{t as q}from"./button-DCB7VoVL.js";import"./dist-C6GW8SWp.js";import"./dist-BFSjfL-I.js";import"./Output-nN1GOw3k.js";import"./once-C5bmD4W5.js";import"./capabilities-MLRWIHmO.js";import"./cjs-Ck8KMDI1.js";import"./createReducer-CTvsuJZY.js";import{r as or}from"./requests-CftYh9v2.js";import"./preload-helper-BnutJmlU.js";import"./dist-0FJpM7wG.js";import"./dist-DrAMGx2E.js";import"./dist-CZkQ2hcE.js";import"./dist-BrS3KFEl.js";import"./dist-DvTgOH5F.js";import"./dist-YP2XXp1Z.js";import"./stex-xveX5l_T.js";import"./Deferred-NfAvvkGM.js";import"./uuid-D0hUC3Qw.js";import"./key-CaC9xuXQ.js";import{t as lr}from"./use-toast-BBrPeu2N.js";import"./main-ChjX94eX.js";import"./marked.esm-BV7g2d65.js";import"./connection-DOETP_K0.js";import"./dist-CvIoRIOp.js";import"./useLifecycle-DiLWmtpP.js";import"./useTheme-C1t46HlN.js";import"./createLucideIcon-DbfgBYhq.js";import{E as ir,O as sr,S as ar,T as nr,_ as cr,c as ct,d as mr,f as dr,l as pr,m as ur,n as mt,p as hr,u as dt,y as fr}from"./add-cell-with-ai-B-hltL9V.js";import"./between-horizontal-start-DDhAeomy.js";import{n as Ze,t as xr}from"./square-C2sucLEB.js";import{c as vr,o as gr,t as br}from"./ai-model-dropdown-6fVxZc7s.js";import{i as wr,n as pt}from"./state-C2v7cmd-.js";import"./type-CnQq0uaD.js";import"./table-CTK995oK.js";import"./check-DqnGmZZE.js";import{a as jr,i as yr,n as Sr,p as Nr,r as Cr,s as _r,t as Rr}from"./select-BkT3QHmw.js";import"./download-3twj9Xwh.js";import"./chevron-right-Bu29x-gp.js";import{a as Tr}from"./maps-BGCWjJqb.js";import{n as Ar}from"./plug-DZNnmiy1.js";import"./toDate-CbcWqY6f.js";import{t as Er}from"./circle-x-65ujNh_O.js";import"./dropdown-menu-CN5aVh8R.js";import"./copy-4VJP-N0g.js";import"./download-BYnrx3yk.js";import"./file-text-br2BVDBF.js";import"./file-D9scEdAT.js";import"./image-q2J0VxlK.js";import{n as ut}from"./spinner-DXjgT_d6.js";import{l as Lr}from"./MarimoErrorOutput-CAtwsmR1.js";import{n as Pr,t as zr}from"./send-Cda8V3YD.js";import"./name-cell-input-DFksRedA.js";import{t as kr}from"./plus-DVSnLdy5.js";import"./refresh-cw-CFk1MA73.js";import{r as ht,st as Ir}from"./input-BYmR6HBp.js";import{t as Dr}from"./settings-DukM6PkA.js";import"./ConsoleOutput-Dv7htISD.js";import{r as ft,t as Mr}from"./state-HLf_9r-5.js";import"./form-C4OqdpTP.js";import"./trash-2-YwvEZLT8.js";import"./trash-mOekSI_N.js";import"./triangle-alert-BBtcXh_3.js";import"./badge-Dlbidp5Z.js";import{S as J,_ as xe,g as $,w as Fr,x as Or,y as De}from"./Combination-ChP9ffHH.js";import"./dist-CLwJsV2W.js";import{i as xt,t as me}from"./tooltip-fQCr9gxe.js";import{u as Wr}from"./menu-items-DwJgssBv.js";import"./useNonce-DJX1XgWY.js";import"./en-US-D9Lph-mE.js";import"./isValid-CJoeYwPo.js";import"./mode-BvhOdC_B.js";import"./alert-dialog-81myxzgR.js";import"./dialog-B0ZQRYmN.js";import"./VisuallyHidden-fFcUDWss.js";import"./usePress-BJP5uSM9.js";import"./SSRProvider-BufkqsXB.js";import"./useDateFormatter-Bt93nQ51.js";import{t as Hr}from"./context-CmoHMC3k.js";import"./useNumberFormatter-BCRD3Xiy.js";import"./shim-CL-N1TlJ.js";import"./useHotkey-DWz-THL8.js";import"./numbers-Da0UyJ4q.js";import{n as Q}from"./useEvent-2G6_06QI.js";import"./useDebounce-88MnHfxr.js";import"./ImperativeModal-wjVZ4eQS.js";import"./strings-DoNzvBC8.js";import{n as Ur}from"./error-banner-C8bnn_Oj.js";import"./vega-loader.browser-BVwjVCQc.js";import"./precisionRound-B2LwJfpR.js";import"./defaultLocale-CNK_a8Z2.js";import"./defaultLocale-Mn032I1s.js";import"./copy-CvoiXuJX.js";import{t as Yr}from"./copy-icon-DNw8yyV3.js";import"./RenderHTML-BPePlDKV.js";import"./purify.es-Cz-BfAJO.js";import"./useRunCells-DyCvt_J0.js";import{a as vt,i as gt,n as bt,r as wt}from"./multi-map-DOgPLTwj.js";import"./emotion-is-prop-valid.esm-jr96H-64.js";import"./extends-BUnZS06R.js";import"./prop-types-CElKCMhv.js";import"./objectWithoutPropertiesLoose-DuRO3TFS.js";import"./alert-Uyjokbhs.js";import"./useAsyncData-CXeJJDVW.js";import"./kbd-f3Vl6KVv.js";import"./renderShortcut-WvNIumsP.js";import"./label-DoQ8dPQj.js";import"./LazyAnyLanguageCodeMirror-BmYv6_Y6.js";import{i as Xr,r as qr,t as Vr}from"./popover-y-4eU0xo.js";import"./cell-link-C_YhUpui.js";import"./dist-ByBamzbc.js";import"./dist-BqQuenSr.js";import"./dist-CA2lBgvV.js";import"./dist-CdeBdpnu.js";import"./dist-DLJRvE7V.js";import"./dist-BYOmBsk_.js";import"./dist-DyBtC3F_.js";import"./dist-BWGrOCqz.js";import"./dist-CUrxoONf.js";import"./dist-BTy2AO2F.js";import"./dist-Bf-v2eRP.js";import"./dist-BMjSE6I1.js";import"./apl-BbjuiDsS.js";import"./asciiarmor-DTXJDFvM.js";import"./asn1-By269rpU.js";import"./brainfuck-Bcb3sDkN.js";import"./cobol-CfB_KfUl.js";import"./clike-D4Hc6kDf.js";import"./clojure-Di966kl0.js";import"./css-CikpO4hp.js";import"./cmake-EdqYjU-h.js";import"./coffeescript-CZnv20P1.js";import"./commonlisp-B_wA9NNL.js";import"./cypher-DAN695K7.js";import"./python--KWNfsxx.js";import"./crystal-B5VE-DHo.js";import"./d-Cp2O9KNQ.js";import"./diff-CaYK6FdG.js";import"./dtd-CKpjjiwC.js";import"./dylan-BwFScnVi.js";import"./ecl-DRplsGLw.js";import"./eiffel-Uz6uj6V8.js";import"./elm-W_885aoq.js";import"./erlang-Dm0JOfW3.js";import"./simple-mode-H9lcpICo.js";import"./factor-Cv1PFcda.js";import"./forth-B_l0qIWF.js";import"./fortran-CLxZdPOJ.js";import"./mllike-1RsOiz7E.js";import"./gas-CWKXfdKr.js";import"./gherkin-DlSGfHGe.js";import"./groovy-CgF94U6E.js";import"./haskell-D8PgguQh.js";import"./haxe-GK8_kbF8.js";import"./idl-Q7A7KWLA.js";import"./javascript-CyIGUINn.js";import"./esm-BwqUR0TG.js";import"./julia-CQO0ko_c.js";import"./livescript-CmgdKnEH.js";import"./lua-mT6czOLr.js";import"./mirc-D24moCA0.js";import"./mathematica-yr8Kagso.js";import"./modelica-Bmw70I7C.js";import"./mumps-CuBXsA1c.js";import"./mbox-DwCdX69t.js";import"./nsis-P2ivpou9.js";import"./ntriples-CFrQmJZ8.js";import"./octave-BE_1B5hT.js";import"./oz-B8qIV9R9.js";import"./pascal-Dm4iZfnp.js";import"./perl-DuC7Sc1M.js";import"./pig-Dj3wv73m.js";import"./powershell-CJYdAA3Z.js";import"./properties-CPd1j9nt.js";import"./protobuf-BD6S47qV.js";import"./pug-BEDx7tiF.js";import"./puppet-BRGJzdBr.js";import"./q-KhF-lSPY.js";import"./r-Casg9NL_.js";import"./rpm-CLm8BZN9.js";import"./ruby-kjKq0O38.js";import"./sas-CNUs9bYJ.js";import"./scheme-H3s5l6ia.js";import"./shell-YvTPydQ4.js";import"./sieve-609IkA1k.js";import"./smalltalk-D3NOidyD.js";import"./sparql-CC3YRBhS.js";import"./stylus-DanbRWv8.js";import"./swift-qtGHoPyl.js";import"./verilog-n25-NWOh.js";import"./tcl-0XlfOish.js";import"./textile-BsUNa0ba.js";import"./toml-BkvbWdmE.js";import"./troff-BM7wyERf.js";import"./ttcn-In-Os3qL.js";import"./ttcn-cfg-6rqcHSj6.js";import"./turtle-N2LAl97c.js";import"./webidl-BsEgPfe4.js";import"./vb-CHmuFJt3.js";import"./vbscript-DwRleoLn.js";import"./velocity-DK0DZeo3.js";import"./vhdl-DJ2vn3A6.js";import"./xquery-Cn6JUpeM.js";import"./yacas-ZFTwhpzI.js";import"./z80-Ct8aYSc-.js";import"./mscgen-Dvk53jZ9.js";import"./dist-CdaKSxCx.js";import"./esm-DWtLTXrW.js";import"./links-L8RfsBvj.js";import"./useIframeCapabilities-CE7UrR0d.js";import"./lazy-DGC5ohlw.js";import"./tabs-DmZtZQ_N.js";import"./command-hjwnCrLr.js";import"./table-D7dxF_z5.js";import"./formats-B6WeWt9C.js";import"./blob-ISoY06EG.js";import"./useDeleteCell-BBvlHSmp.js";import"./add-missing-import-CMKdLyLj.js";import"./icons-DNkkeQqC.js";import"./focus-DkcYPAN0.js";import"./textarea-DxQAjCBZ.js";import"./switch-CNBsJN9T.js";import"./dist-BZ1K6w-X.js";import"./katex-CkJcqOLL.js";import{n as Br,r as Ge,t as Jr}from"./chat-components-96dRaVQd.js";import{t as Ke}from"./empty-state-Bz-ss1X9.js";var jt=ne(Ie(),1),h=ne(Bt(),1);const $r=({chatState:t,chatId:e,messages:r})=>{if(!e)return B.warn("No active chat"),t;let s=t.chats.get(e);if(!s)return B.warn("No active chat"),t;let l=new Map(t.chats),i=Date.now();return l.set(s.id,{...s,messages:r,updatedAt:i}),{...t,chats:l}};var o=ne(rr(),1);function Qr(t,e){return h.useReducer((r,s)=>e[r][s]??r,t)}var et="ScrollArea",[yt,Xn]=Fr(et),[Zr,O]=yt(et),St=h.forwardRef((t,e)=>{let{__scopeScrollArea:r,type:s="hover",dir:l,scrollHideDelay:i=600,...a}=t,[n,c]=h.useState(null),[d,m]=h.useState(null),[p,u]=h.useState(null),[f,g]=h.useState(null),[j,b]=h.useState(null),[x,C]=h.useState(0),[S,N]=h.useState(0),[_,R]=h.useState(!1),[L,P]=h.useState(!1),w=ce(e,z=>c(z)),A=Wr(l);return(0,o.jsx)(Zr,{scope:r,type:s,dir:A,scrollHideDelay:i,scrollArea:n,viewport:d,onViewportChange:m,content:p,onContentChange:u,scrollbarX:f,onScrollbarXChange:g,scrollbarXEnabled:_,onScrollbarXEnabledChange:R,scrollbarY:j,onScrollbarYChange:b,scrollbarYEnabled:L,onScrollbarYEnabledChange:P,onCornerWidthChange:C,onCornerHeightChange:N,children:(0,o.jsx)(xe.div,{dir:A,...a,ref:w,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":S+"px",...t.style}})})});St.displayName=et;var Nt="ScrollAreaViewport",Ct=h.forwardRef((t,e)=>{let{__scopeScrollArea:r,children:s,nonce:l,...i}=t,a=O(Nt,r),n=ce(e,h.useRef(null),a.onViewportChange);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:l}),(0,o.jsx)(xe.div,{"data-radix-scroll-area-viewport":"",...i,ref:n,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...t.style},children:(0,o.jsx)("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:s})})]})});Ct.displayName=Nt;var U="ScrollAreaScrollbar",tt=h.forwardRef((t,e)=>{let{forceMount:r,...s}=t,l=O(U,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:a}=l,n=t.orientation==="horizontal";return h.useEffect(()=>(n?i(!0):a(!0),()=>{n?i(!1):a(!1)}),[n,i,a]),l.type==="hover"?(0,o.jsx)(Gr,{...s,ref:e,forceMount:r}):l.type==="scroll"?(0,o.jsx)(Kr,{...s,ref:e,forceMount:r}):l.type==="auto"?(0,o.jsx)(_t,{...s,ref:e,forceMount:r}):l.type==="always"?(0,o.jsx)(rt,{...s,ref:e}):null});tt.displayName=U;var Gr=h.forwardRef((t,e)=>{let{forceMount:r,...s}=t,l=O(U,t.__scopeScrollArea),[i,a]=h.useState(!1);return h.useEffect(()=>{let n=l.scrollArea,c=0;if(n){let d=()=>{window.clearTimeout(c),a(!0)},m=()=>{c=window.setTimeout(()=>a(!1),l.scrollHideDelay)};return n.addEventListener("pointerenter",d),n.addEventListener("pointerleave",m),()=>{window.clearTimeout(c),n.removeEventListener("pointerenter",d),n.removeEventListener("pointerleave",m)}}},[l.scrollArea,l.scrollHideDelay]),(0,o.jsx)(De,{present:r||i,children:(0,o.jsx)(_t,{"data-state":i?"visible":"hidden",...s,ref:e})})}),Kr=h.forwardRef((t,e)=>{let{forceMount:r,...s}=t,l=O(U,t.__scopeScrollArea),i=t.orientation==="horizontal",a=We(()=>c("SCROLL_END"),100),[n,c]=Qr("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return h.useEffect(()=>{if(n==="idle"){let d=window.setTimeout(()=>c("HIDE"),l.scrollHideDelay);return()=>window.clearTimeout(d)}},[n,l.scrollHideDelay,c]),h.useEffect(()=>{let d=l.viewport,m=i?"scrollLeft":"scrollTop";if(d){let p=d[m],u=()=>{let f=d[m];p!==f&&(c("SCROLL"),a()),p=f};return d.addEventListener("scroll",u),()=>d.removeEventListener("scroll",u)}},[l.viewport,i,c,a]),(0,o.jsx)(De,{present:r||n!=="hidden",children:(0,o.jsx)(rt,{"data-state":n==="hidden"?"hidden":"visible",...s,ref:e,onPointerEnter:J(t.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:J(t.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),_t=h.forwardRef((t,e)=>{let r=O(U,t.__scopeScrollArea),{forceMount:s,...l}=t,[i,a]=h.useState(!1),n=t.orientation==="horizontal",c=We(()=>{if(r.viewport){let d=r.viewport.offsetWidth<r.viewport.scrollWidth,m=r.viewport.offsetHeight<r.viewport.scrollHeight;a(n?d:m)}},10);return de(r.viewport,c),de(r.content,c),(0,o.jsx)(De,{present:s||i,children:(0,o.jsx)(rt,{"data-state":i?"visible":"hidden",...l,ref:e})})}),rt=h.forwardRef((t,e)=>{let{orientation:r="vertical",...s}=t,l=O(U,t.__scopeScrollArea),i=h.useRef(null),a=h.useRef(0),[n,c]=h.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=Lt(n.viewport,n.content),m={...s,sizes:n,onSizesChange:c,hasThumb:d>0&&d<1,onThumbChange:u=>i.current=u,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:u=>a.current=u};function p(u,f){return io(u,a.current,n,f)}return r==="horizontal"?(0,o.jsx)(eo,{...m,ref:e,onThumbPositionChange:()=>{if(l.viewport&&i.current){let u=l.viewport.scrollLeft,f=Pt(u,n,l.dir);i.current.style.transform=`translate3d(${f}px, 0, 0)`}},onWheelScroll:u=>{l.viewport&&(l.viewport.scrollLeft=u)},onDragScroll:u=>{l.viewport&&(l.viewport.scrollLeft=p(u,l.dir))}}):r==="vertical"?(0,o.jsx)(to,{...m,ref:e,onThumbPositionChange:()=>{if(l.viewport&&i.current){let u=l.viewport.scrollTop,f=Pt(u,n);i.current.style.transform=`translate3d(0, ${f}px, 0)`}},onWheelScroll:u=>{l.viewport&&(l.viewport.scrollTop=u)},onDragScroll:u=>{l.viewport&&(l.viewport.scrollTop=p(u))}}):null}),eo=h.forwardRef((t,e)=>{let{sizes:r,onSizesChange:s,...l}=t,i=O(U,t.__scopeScrollArea),[a,n]=h.useState(),c=h.useRef(null),d=ce(e,c,i.onScrollbarXChange);return h.useEffect(()=>{c.current&&n(getComputedStyle(c.current))},[c]),(0,o.jsx)(Tt,{"data-orientation":"horizontal",...l,ref:d,sizes:r,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Oe(r)+"px",...t.style},onThumbPointerDown:m=>t.onThumbPointerDown(m.x),onDragScroll:m=>t.onDragScroll(m.x),onWheelScroll:(m,p)=>{if(i.viewport){let u=i.viewport.scrollLeft+m.deltaX;t.onWheelScroll(u),kt(u,p)&&m.preventDefault()}},onResize:()=>{c.current&&i.viewport&&a&&s({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:Fe(a.paddingLeft),paddingEnd:Fe(a.paddingRight)}})}})}),to=h.forwardRef((t,e)=>{let{sizes:r,onSizesChange:s,...l}=t,i=O(U,t.__scopeScrollArea),[a,n]=h.useState(),c=h.useRef(null),d=ce(e,c,i.onScrollbarYChange);return h.useEffect(()=>{c.current&&n(getComputedStyle(c.current))},[c]),(0,o.jsx)(Tt,{"data-orientation":"vertical",...l,ref:d,sizes:r,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Oe(r)+"px",...t.style},onThumbPointerDown:m=>t.onThumbPointerDown(m.y),onDragScroll:m=>t.onDragScroll(m.y),onWheelScroll:(m,p)=>{if(i.viewport){let u=i.viewport.scrollTop+m.deltaY;t.onWheelScroll(u),kt(u,p)&&m.preventDefault()}},onResize:()=>{c.current&&i.viewport&&a&&s({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:Fe(a.paddingTop),paddingEnd:Fe(a.paddingBottom)}})}})}),[ro,Rt]=yt(U),Tt=h.forwardRef((t,e)=>{let{__scopeScrollArea:r,sizes:s,hasThumb:l,onThumbChange:i,onThumbPointerUp:a,onThumbPointerDown:n,onThumbPositionChange:c,onDragScroll:d,onWheelScroll:m,onResize:p,...u}=t,f=O(U,r),[g,j]=h.useState(null),b=ce(e,w=>j(w)),x=h.useRef(null),C=h.useRef(""),S=f.viewport,N=s.content-s.viewport,_=$(m),R=$(c),L=We(p,10);function P(w){x.current&&d({x:w.clientX-x.current.left,y:w.clientY-x.current.top})}return h.useEffect(()=>{let w=A=>{let z=A.target;g!=null&&g.contains(z)&&_(A,N)};return document.addEventListener("wheel",w,{passive:!1}),()=>document.removeEventListener("wheel",w,{passive:!1})},[S,g,N,_]),h.useEffect(R,[s,R]),de(g,L),de(f.content,L),(0,o.jsx)(ro,{scope:r,scrollbar:g,hasThumb:l,onThumbChange:$(i),onThumbPointerUp:$(a),onThumbPositionChange:R,onThumbPointerDown:$(n),children:(0,o.jsx)(xe.div,{...u,ref:b,style:{position:"absolute",...u.style},onPointerDown:J(t.onPointerDown,w=>{w.button===0&&(w.target.setPointerCapture(w.pointerId),x.current=g.getBoundingClientRect(),C.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",f.viewport&&(f.viewport.style.scrollBehavior="auto"),P(w))}),onPointerMove:J(t.onPointerMove,P),onPointerUp:J(t.onPointerUp,w=>{let A=w.target;A.hasPointerCapture(w.pointerId)&&A.releasePointerCapture(w.pointerId),document.body.style.webkitUserSelect=C.current,f.viewport&&(f.viewport.style.scrollBehavior=""),x.current=null})})})}),Me="ScrollAreaThumb",At=h.forwardRef((t,e)=>{let{forceMount:r,...s}=t,l=Rt(Me,t.__scopeScrollArea);return(0,o.jsx)(De,{present:r||l.hasThumb,children:(0,o.jsx)(oo,{ref:e,...s})})}),oo=h.forwardRef((t,e)=>{let{__scopeScrollArea:r,style:s,...l}=t,i=O(Me,r),a=Rt(Me,r),{onThumbPositionChange:n}=a,c=ce(e,p=>a.onThumbChange(p)),d=h.useRef(void 0),m=We(()=>{d.current&&(d.current=(d.current(),void 0))},100);return h.useEffect(()=>{let p=i.viewport;if(p){let u=()=>{m(),d.current||(d.current=so(p,n),n())};return n(),p.addEventListener("scroll",u),()=>p.removeEventListener("scroll",u)}},[i.viewport,m,n]),(0,o.jsx)(xe.div,{"data-state":a.hasThumb?"visible":"hidden",...l,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:J(t.onPointerDownCapture,p=>{let u=p.target.getBoundingClientRect(),f=p.clientX-u.left,g=p.clientY-u.top;a.onThumbPointerDown({x:f,y:g})}),onPointerUp:J(t.onPointerUp,a.onThumbPointerUp)})});At.displayName=Me;var ot="ScrollAreaCorner",Et=h.forwardRef((t,e)=>{let r=O(ot,t.__scopeScrollArea),s=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&s?(0,o.jsx)(lo,{...t,ref:e}):null});Et.displayName=ot;var lo=h.forwardRef((t,e)=>{let{__scopeScrollArea:r,...s}=t,l=O(ot,r),[i,a]=h.useState(0),[n,c]=h.useState(0),d=!!(i&&n);return de(l.scrollbarX,()=>{var p;let m=((p=l.scrollbarX)==null?void 0:p.offsetHeight)||0;l.onCornerHeightChange(m),c(m)}),de(l.scrollbarY,()=>{var p;let m=((p=l.scrollbarY)==null?void 0:p.offsetWidth)||0;l.onCornerWidthChange(m),a(m)}),d?(0,o.jsx)(xe.div,{...s,ref:e,style:{width:i,height:n,position:"absolute",right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function Fe(t){return t?parseInt(t,10):0}function Lt(t,e){let r=t/e;return isNaN(r)?0:r}function Oe(t){let e=Lt(t.viewport,t.content),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,s=(t.scrollbar.size-r)*e;return Math.max(s,18)}function io(t,e,r,s="ltr"){let l=Oe(r),i=l/2,a=e||i,n=l-a,c=r.scrollbar.paddingStart+a,d=r.scrollbar.size-r.scrollbar.paddingEnd-n,m=r.content-r.viewport,p=s==="ltr"?[0,m]:[m*-1,0];return zt([c,d],p)(t)}function Pt(t,e,r="ltr"){let s=Oe(e),l=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-l,a=e.content-e.viewport,n=i-s,c=Nr(t,r==="ltr"?[0,a]:[a*-1,0]);return zt([0,a],[0,n])(c)}function zt(t,e){return r=>{if(t[0]===t[1]||e[0]===e[1])return e[0];let s=(e[1]-e[0])/(t[1]-t[0]);return e[0]+s*(r-t[0])}}function kt(t,e){return t>0&&t<e}var so=(t,e=()=>{})=>{let r={left:t.scrollLeft,top:t.scrollTop},s=0;return(function l(){let i={left:t.scrollLeft,top:t.scrollTop},a=r.left!==i.left,n=r.top!==i.top;(a||n)&&e(),r=i,s=window.requestAnimationFrame(l)})(),()=>window.cancelAnimationFrame(s)};function We(t,e){let r=$(t),s=h.useRef(0);return h.useEffect(()=>()=>window.clearTimeout(s.current),[]),h.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(r,e)},[r,e])}function de(t,e){let r=$(e);Or(()=>{let s=0;if(t){let l=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(r)});return l.observe(t),()=>{window.cancelAnimationFrame(s),l.unobserve(t)}}},[t,r])}var It=St,ao=Ct,no=Et,Dt=h.forwardRef((t,e)=>{let r=(0,jt.c)(15),s,l,i;r[0]===t?(s=r[1],l=r[2],i=r[3]):({className:l,children:s,...i}=t,r[0]=t,r[1]=s,r[2]=l,r[3]=i);let a;r[4]===l?a=r[5]:(a=V("relative overflow-hidden",l),r[4]=l,r[5]=a);let n;r[6]===s?n=r[7]:(n=(0,o.jsx)(ao,{className:"h-full w-full rounded-[inherit]",children:s}),r[6]=s,r[7]=n);let c,d;r[8]===Symbol.for("react.memo_cache_sentinel")?(c=(0,o.jsx)(Mt,{}),d=(0,o.jsx)(no,{}),r[8]=c,r[9]=d):(c=r[8],d=r[9]);let m;return r[10]!==i||r[11]!==e||r[12]!==a||r[13]!==n?(m=(0,o.jsxs)(It,{ref:e,className:a,...i,children:[n,c,d]}),r[10]=i,r[11]=e,r[12]=a,r[13]=n,r[14]=m):m=r[14],m});Dt.displayName=It.displayName;var Mt=h.forwardRef((t,e)=>{let r=(0,jt.c)(14),s,l,i;r[0]===t?(s=r[1],l=r[2],i=r[3]):({className:s,orientation:i,...l}=t,r[0]=t,r[1]=s,r[2]=l,r[3]=i);let a=i===void 0?"vertical":i,n=a==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-px",c=a==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-px",d;r[4]!==s||r[5]!==n||r[6]!==c?(d=V("flex touch-none select-none transition-colors",n,c,s),r[4]=s,r[5]=n,r[6]=c,r[7]=d):d=r[7];let m;r[8]===Symbol.for("react.memo_cache_sentinel")?(m=(0,o.jsx)(At,{className:"relative flex-1 rounded-full bg-border"}),r[8]=m):m=r[8];let p;return r[9]!==a||r[10]!==l||r[11]!==e||r[12]!==d?(p=(0,o.jsx)(tt,{ref:e,orientation:a,className:d,...l,children:m}),r[9]=a,r[10]=l,r[11]=e,r[12]=d,r[13]=p):p=r[13],p});Mt.displayName=tt.displayName;var co=[{label:"Today",days:0},{label:"Yesterday",days:1},{label:"2d ago",days:2},{label:"3d ago",days:3},{label:"This week",days:7},{label:"This month",days:30}];const mo=t=>{let e=Date.now(),r=co.map(i=>({...i,chats:[]})),s={label:"Older",days:1/0,chats:[]},l=i=>{switch(i){case 0:return r[0];case 1:return r[1];case 2:return r[2];case 3:return r[3];default:return i>=4&&i<=7?r[4]:i>=8&&i<=30?r[5]:s}};for(let i of t)l(Math.floor((e-i.updatedAt)/864e5)).chats.push(i);return[...r,s].filter(i=>i.chats.length>0)},po=({activeChatId:t,setActiveChat:e})=>{let r=$e(ft),{locale:s}=Hr(),[l,i]=(0,h.useState)(""),a=(0,h.useMemo)(()=>[...r.chats.values()].sort((d,m)=>m.updatedAt-d.updatedAt),[r.chats]),n=(0,h.useMemo)(()=>l.trim()?a.filter(d=>d.title.toLowerCase().includes(l.toLowerCase())):a,[a,l]),c=(0,h.useMemo)(()=>mo(n),[n]);return(0,o.jsxs)(Vr,{children:[(0,o.jsx)(me,{content:"Previous chats",children:(0,o.jsx)(Xr,{asChild:!0,children:(0,o.jsx)(q,{variant:"text",size:"icon",children:(0,o.jsx)($t,{className:"h-4 w-4"})})})}),(0,o.jsxs)(qr,{className:"w-[480px] p-0",align:"start",side:"right",children:[(0,o.jsx)("div",{className:"pt-3 px-3 w-full",children:(0,o.jsx)(ht,{placeholder:"Search chat history...",value:l,onChange:d=>i(d.target.value),className:"text-xs"})}),(0,o.jsx)(Dt,{className:"h-[450px] p-2",children:(0,o.jsxs)("div",{className:"space-y-3",children:[a.length===0&&(0,o.jsx)(Ke,{title:"No chats yet",description:"Start a new chat to get started",icon:(0,o.jsx)(Ze,{})}),n.length===0&&l&&a.length>0&&(0,o.jsx)(Ke,{title:"No chats found",description:`No chats match "${l}"`,icon:(0,o.jsx)(Ir,{})}),c.map((d,m)=>(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)("div",{className:"text-xs px-1 text-muted-foreground/60",children:d.label}),(0,o.jsx)("div",{children:d.chats.map(p=>(0,o.jsxs)("button",{className:V("w-full p-1 rounded-md cursor-pointer text-left flex items-center justify-between",p.id===t&&"bg-accent",p.id!==t&&"hover:bg-muted/20"),onClick:()=>{e(p.id)},type:"button",children:[(0,o.jsx)("div",{className:"flex-1 min-w-0",children:(0,o.jsx)("div",{className:"text-sm truncate",children:p.title})}),(0,o.jsx)("div",{className:"text-xs text-muted-foreground/60 ml-2 flex-shrink-0",children:Tr(p.updatedAt,s)})]},p.id))}),m!==c.length-1&&(0,o.jsx)("hr",{})]},d.label))]})})]})]})};var uo=ne(Ie(),1);const ho=t=>{let e=(0,uo.c)(13),{reasoning:r,index:s,isStreaming:l}=t,i=s===void 0?0:s,a=l===void 0?!1:l,n=a?"reasoning":void 0,c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=(0,o.jsx)(Ze,{className:"h-3 w-3"}),e[0]=c):c=e[0];let d=a?"Thinking":"View reasoning",m;e[1]!==r.length||e[2]!==d?(m=(0,o.jsx)(vt,{className:"text-xs text-muted-foreground hover:bg-muted/50 px-2 py-1 h-auto rounded-sm [&[data-state=open]>svg]:rotate-180",children:(0,o.jsxs)("span",{className:"flex items-center gap-2",children:[c,d," (",r.length," ","chars)"]})}),e[1]=r.length,e[2]=d,e[3]=m):m=e[3];let p;e[4]===r?p=e[5]:(p=(0,o.jsx)(wt,{className:"pb-2 px-2",children:(0,o.jsx)("div",{className:"bg-muted/30 border border-muted/50 rounded-md p-3 italic text-muted-foreground/90 relative",children:(0,o.jsx)("div",{className:"pr-6",children:(0,o.jsx)(Ge,{content:r})})})}),e[4]=r,e[5]=p);let u;e[6]!==m||e[7]!==p?(u=(0,o.jsxs)(gt,{value:"reasoning",className:"border-0",children:[m,p]}),e[6]=m,e[7]=p,e[8]=u):u=e[8];let f;return e[9]!==i||e[10]!==n||e[11]!==u?(f=(0,o.jsx)(bt,{type:"single",collapsible:!0,className:"w-full mb-2",value:n,children:u},i),e[9]=i,e[10]=n,e[11]=u,e[12]=f):f=e[12],f};var He=ne(Ie(),1),fo=Kt({status:st().default("success"),auth_required:Gt().default(!1),action_url:Qe(),next_steps:Qe(),meta:Qe(),message:st().nullish()}).passthrough(),xo=t=>{let e=(0,He.c)(12),{data:r}=t,s;if(e[0]!==r){let{status:l,auth_required:i,action_url:a,meta:n,next_steps:c,message:d,...m}=r,p;e[2]===Symbol.for("react.memo_cache_sentinel")?(p=(0,o.jsx)("h3",{className:"text-xs font-semibold text-muted-foreground",children:"Tool Result"}),e[2]=p):p=e[2];let u;e[3]===l?u=e[4]:(u=(0,o.jsx)("span",{className:"text-xs px-2 py-0.5 bg-[var(--grass-2)] text-[var(--grass-11)] rounded-full font-medium capitalize",children:l}),e[3]=l,e[4]=u);let f;e[5]===i?f=e[6]:(f=i&&(0,o.jsx)("span",{className:"text-xs px-2 py-0.5 bg-[var(--amber-2)] text-[var(--amber-11)] rounded-full",children:"Auth Required"}),e[5]=i,e[6]=f);let g;e[7]!==u||e[8]!==f?(g=(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[p,(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[u,f]})]}),e[7]=u,e[8]=f,e[9]=g):g=e[9];let j;e[10]===d?j=e[11]:(j=d&&(0,o.jsxs)("div",{className:"flex items-start gap-2",children:[(0,o.jsx)(Qt,{className:"h-3 w-3 text-[var(--blue-11)] mt-0.5 flex-shrink-0"}),(0,o.jsx)("div",{className:"text-xs text-foreground",children:d})]}),e[10]=d,e[11]=j),s=(0,o.jsxs)("div",{className:"flex flex-col gap-1.5",children:[g,j,m&&(0,o.jsx)("div",{className:"space-y-3",children:Object.entries(m).map(wo)})]}),e[0]=r,e[1]=s}else s=e[1];return s},vo=t=>{let e=(0,He.c)(8),{result:r}=t,s;e[0]===r?s=e[1]:(s=fo.safeParse(r),e[0]=r,e[1]=s);let l=s;if(l.success){let n;return e[2]===l.data?n=e[3]:(n=(0,o.jsx)(xo,{data:l.data}),e[2]=l.data,e[3]=n),n}let i;e[4]===r?i=e[5]:(i=typeof r=="string"?r:JSON.stringify(r,null,2),e[4]=r,e[5]=i);let a;return e[6]===i?a=e[7]:(a=(0,o.jsx)("div",{className:"text-xs font-medium text-muted-foreground mb-1 max-h-64 overflow-y-auto scrollbar-thin",children:i}),e[6]=i,e[7]=a),a},go=t=>{let e=(0,He.c)(9),{input:r}=t;if(!(r&&r!==null))return null;let s;e[0]===r?s=e[1]:(s=at(r),e[0]=r,e[1]=s);let l=s,i=typeof r=="object"&&Object.keys(r).length>0,a;e[2]===Symbol.for("react.memo_cache_sentinel")?(a=(0,o.jsx)("h3",{className:"text-xs font-semibold text-muted-foreground",children:"Tool Request"}),e[2]=a):a=e[2];let n;e[3]!==r||e[4]!==l||e[5]!==i?(n=l?"{}":i?JSON.stringify(r,null,2):String(r),e[3]=r,e[4]=l,e[5]=i,e[6]=n):n=e[6];let c;return e[7]===n?c=e[8]:(c=(0,o.jsxs)("div",{className:"space-y-2",children:[a,(0,o.jsx)("pre",{className:"bg-[var(--slate-2)] p-2 text-muted-foreground border border-[var(--slate-4)] rounded text-xs overflow-auto scrollbar-thin max-h-64",children:n})]}),e[7]=n,e[8]=c),c};const Ft=t=>{let e=(0,He.c)(38),{toolName:r,result:s,error:l,index:i,state:a,className:n,input:c}=t,d=i===void 0?0:i,m=a==="output-available"&&(s||l),p=l?"error":m?"success":"loading",u;e[0]===p?u=e[1]:(u=()=>{switch(p){case"loading":return(0,o.jsx)(ut,{className:"h-3 w-3 animate-spin"});case"error":return(0,o.jsx)(Er,{className:"h-3 w-3 text-[var(--red-11)]"});case"success":return(0,o.jsx)(Ar,{className:"h-3 w-3 text-[var(--grass-11)]"});default:return(0,o.jsx)(Lr,{className:"h-3 w-3"})}},e[0]=p,e[1]=u);let f=u,g;e[2]!==l||e[3]!==m||e[4]!==p?(g=()=>p==="loading"?"Running":l?"Failed":m?"Done":"Tool call",e[2]=l,e[3]=m,e[4]=p,e[5]=g):g=e[5];let j=g,b=`tool-${d}`,x;e[6]===n?x=e[7]:(x=V("w-full",n),e[6]=n,e[7]=x);let C=p==="error"&&"text-[var(--red-11)]/80",S=p==="success"&&"text-[var(--grass-11)]/80",N;e[8]!==C||e[9]!==S?(N=V("h-6 text-xs border-border shadow-none! ring-0! bg-muted/60 hover:bg-muted py-0 px-2 gap-1 rounded-sm [&[data-state=open]>svg]:rotate-180 hover:no-underline",C,S),e[8]=C,e[9]=S,e[10]=N):N=e[10];let _;e[11]===f?_=e[12]:(_=f(),e[11]=f,e[12]=_);let R=j(),L;e[13]===r?L=e[14]:(L=bo(r),e[13]=r,e[14]=L);let P;e[15]===L?P=e[16]:(P=(0,o.jsx)("code",{className:"font-mono text-xs",children:L}),e[15]=L,e[16]=P);let w;e[17]!==R||e[18]!==P||e[19]!==_?(w=(0,o.jsxs)("span",{className:"flex items-center gap-1",children:[_,R,":",P]}),e[17]=R,e[18]=P,e[19]=_,e[20]=w):w=e[20];let A;e[21]!==w||e[22]!==N?(A=(0,o.jsx)(vt,{className:N,children:w}),e[21]=w,e[22]=N,e[23]=A):A=e[23];let z;e[24]!==l||e[25]!==m||e[26]!==c||e[27]!==s?(z=m&&(0,o.jsxs)("div",{className:"space-y-3",children:[(0,o.jsx)(go,{input:c}),s!=null&&(0,o.jsx)(vo,{result:s}),l&&(0,o.jsxs)("div",{className:"bg-[var(--red-2)] border border-[var(--red-6)] rounded-lg p-3",children:[(0,o.jsxs)("div",{className:"text-xs font-semibold text-[var(--red-11)] mb-2 flex items-center gap-2",children:[(0,o.jsx)("div",{className:"w-1.5 h-1.5 bg-[var(--red-9)] rounded-full"}),"Error"]}),(0,o.jsx)("div",{className:"text-sm text-[var(--red-11)] leading-relaxed",children:l})]})]}),e[24]=l,e[25]=m,e[26]=c,e[27]=s,e[28]=z):z=e[28];let T;e[29]===z?T=e[30]:(T=(0,o.jsx)(wt,{className:"py-2 px-2",children:z}),e[29]=z,e[30]=T);let E;e[31]!==A||e[32]!==T?(E=(0,o.jsxs)(gt,{value:"tool-call",className:"border-0",children:[A,T]}),e[31]=A,e[32]=T,e[33]=E):E=e[33];let I;return e[34]!==E||e[35]!==b||e[36]!==x?(I=(0,o.jsx)(bt,{type:"single",collapsible:!0,className:x,children:E},b),e[34]=E,e[35]=b,e[36]=x,e[37]=I):I=e[37],I};function bo(t){return t.replace("tool-","")}function wo(t){let[e,r]=t;return at(r)?null:(0,o.jsxs)("div",{className:"space-y-1.5",children:[(0,o.jsxs)("div",{className:"text-xs font-medium text-muted-foreground capitalize flex items-center gap-2",children:[(0,o.jsx)("div",{className:"w-1.5 h-1.5 bg-[var(--blue-9)] rounded-full"}),e]}),(0,o.jsx)("pre",{className:"bg-[var(--slate-2)] p-2 text-muted-foreground border border-[var(--slate-4)] rounded text-xs overflow-auto scrollbar-thin max-h-64",children:JSON.stringify(r,null,2)})]},e)}var pe=ne(Ie(),1),Ot="manual",jo=new Set(["openai","google","anthropic"]),yo=["image/*","text/*"],So=1024*1024*50,No=t=>{let e=(0,pe.c)(18),{onNewChat:r,activeChatId:s,setActiveChat:l}=t,{handleClick:i}=pt(),a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=(0,o.jsx)(kr,{className:"h-4 w-4"}),e[0]=a):a=e[0];let n;e[1]===r?n=e[2]:(n=(0,o.jsx)(me,{content:"New chat",children:(0,o.jsx)(q,{variant:"text",size:"icon",onClick:r,children:a})}),e[1]=r,e[2]=n);let c;e[3]===Symbol.for("react.memo_cache_sentinel")?(c=(0,o.jsx)(wr,{}),e[3]=c):c=e[3];let d;e[4]===i?d=e[5]:(d=()=>i("ai"),e[4]=i,e[5]=d);let m;e[6]===Symbol.for("react.memo_cache_sentinel")?(m=(0,o.jsx)(Dr,{className:"h-4 w-4"}),e[6]=m):m=e[6];let p;e[7]===d?p=e[8]:(p=(0,o.jsx)(me,{content:"AI Settings",children:(0,o.jsx)(q,{variant:"text",size:"xs",className:"hover:bg-foreground/10 py-2",onClick:d,children:m})}),e[7]=d,e[8]=p);let u;e[9]!==s||e[10]!==l?(u=(0,o.jsx)(po,{activeChatId:s,setActiveChat:l}),e[9]=s,e[10]=l,e[11]=u):u=e[11];let f;e[12]!==p||e[13]!==u?(f=(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[c,p,u]}),e[12]=p,e[13]=u,e[14]=f):f=e[14];let g;return e[15]!==n||e[16]!==f?(g=(0,o.jsxs)("div",{className:"flex border-b px-2 py-1 justify-between shrink-0 items-center",children:[n,f]}),e[15]=n,e[16]=f,e[17]=g):g=e[17],g};function Co(t){return t.type.startsWith("tool-")}var Wt=(0,h.memo)(t=>{let e=(0,pe.c)(15),{message:r,index:s,onEdit:l,isStreamingReasoning:i,isLast:a}=t,n;e[0]!==s||e[1]!==l?(n=j=>{var C,S,N;let b=(S=(C=j.parts)==null?void 0:C.filter(Ao))==null?void 0:S.map(Eo).join(`
`),x=(N=j.parts)==null?void 0:N.filter(Lo);return(0,o.jsxs)("div",{className:"w-[95%] bg-background border p-1 rounded-sm",children:[x==null?void 0:x.map(Po),(0,o.jsx)(mt,{value:b,placeholder:"Type your message...",onChange:zo,onSubmit:(_,R)=>{R.trim()&&l(s,R)},onClose:ko},j.id)]})},e[0]=s,e[1]=l,e[2]=n):n=e[2];let c=n,d;e[3]!==a||e[4]!==i?(d=j=>(0,o.jsxs)("div",{className:"w-[95%] wrap-break-word",children:[(0,o.jsx)("div",{className:"absolute right-1 top-1 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,o.jsx)(Yr,{className:"h-3 w-3",value:j.parts.filter(Io).map(Do).join(`
`)||""})}),j.parts.map((b,x)=>{if(Co(b))return(0,o.jsx)(Ft,{index:x,toolName:b.type,result:b.output,className:"my-2",state:b.state,input:b.input},x);switch(b.type){case"text":return(0,o.jsx)(Ge,{content:b.text},x);case"reasoning":return(0,o.jsx)(ho,{reasoning:b.text,index:x,isStreaming:a&&i&&x===(j.parts.length||0)-1},x);case"dynamic-tool":return(0,o.jsx)(Ft,{index:x,toolName:b.type,result:b.output,state:b.state,input:b.input,className:"my-2"},x);case"data-reasoning-signature":return null;default:if(b.type.startsWith("data-"))return B.log("Found data part",b),null;B.error("Unhandled part type:",b.type);try{return(0,o.jsx)("div",{className:"text-xs text-muted-foreground",children:(0,o.jsx)(Ge,{content:JSON.stringify(b,null,2)})},x)}catch(C){let S=C;return B.error("Error rendering part:",b.type,S),null}}})]}),e[3]=a,e[4]=i,e[5]=d):d=e[5];let m=d,p=r.role==="user"?"justify-end":"justify-start",u;e[6]===p?u=e[7]:(u=V("flex group relative",p),e[6]=p,e[7]=u);let f;e[8]!==r||e[9]!==m||e[10]!==c?(f=r.role==="user"?c(r):m(r),e[8]=r,e[9]=m,e[10]=c,e[11]=f):f=e[11];let g;return e[12]!==u||e[13]!==f?(g=(0,o.jsx)("div",{className:u,children:f}),e[12]=u,e[13]=f,e[14]=g):g=e[14],g});Wt.displayName="ChatMessage";var Ht=(0,h.memo)(t=>{var ve;let e=(0,pe.c)(39),{isEmpty:r,onSendClick:s,isLoading:l,onStop:i,fileInputRef:a,onAddFiles:n,onAddContext:c}=t,d=$e(nt),m=(d==null?void 0:d.mode)||Ot,p=((ve=d==null?void 0:d.models)==null?void 0:ve.chat_model)||"openai/gpt-4o",u=gr.parse(p).providerId,{saveModeChange:f}=vr(),g;e[0]===Symbol.for("react.memo_cache_sentinel")?(g=[{value:"ask",label:"Ask",subtitle:"Use AI with access to read-only tools like documentation search"},{value:"manual",label:"Manual",subtitle:"Pure chat, no tool usage"},{value:"agent",label:"Agent (beta)",subtitle:"Use AI with access to read and write tools"}],e[0]=g):g=e[0];let j=g,b=jo.has(u),x;e[1]===m?x=e[2]:(x=(0,o.jsx)(_r,{className:"h-6 text-xs border-border shadow-none! ring-0! bg-muted hover:bg-muted/30 py-0 px-2 gap-1 capitalize",children:m}),e[1]=m,e[2]=x);let C;e[3]===Symbol.for("react.memo_cache_sentinel")?(C=(0,o.jsx)(jr,{children:"AI Mode"}),e[3]=C):C=e[3];let S;e[4]===j?S=e[5]:(S=(0,o.jsx)(Sr,{children:(0,o.jsxs)(Cr,{children:[C,j.map(Mo)]})}),e[4]=j,e[5]=S);let N;e[6]!==m||e[7]!==f||e[8]!==x||e[9]!==S?(N=(0,o.jsx)(Jt,{feature:"chat_modes",children:(0,o.jsxs)(Rr,{value:m,onValueChange:f,children:[x,S]})}),e[6]=m,e[7]=f,e[8]=x,e[9]=S,e[10]=N):N=e[10];let _;e[11]===Symbol.for("react.memo_cache_sentinel")?(_=(0,o.jsx)(br,{placeholder:"Model",triggerClassName:"h-6 text-xs shadow-none! ring-0! bg-muted hover:bg-muted/30 rounded-sm",iconSize:"small",showAddCustomModelDocs:!0,forRole:"chat"}),e[11]=_):_=e[11];let R;e[12]===N?R=e[13]:(R=(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[N,_]}),e[12]=N,e[13]=R);let L;e[14]===Symbol.for("react.memo_cache_sentinel")?(L=(0,o.jsx)(sr,{className:"h-3.5 w-3.5"}),e[14]=L):L=e[14];let P;e[15]!==l||e[16]!==c?(P=(0,o.jsx)(me,{content:"Add context",children:(0,o.jsx)(q,{variant:"text",size:"icon",onClick:c,disabled:l,children:L})}),e[15]=l,e[16]=c,e[17]=P):P=e[17];let w;e[18]!==a||e[19]!==b||e[20]!==l||e[21]!==n?(w=b&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(me,{content:"Attach a file",children:(0,o.jsx)(q,{variant:"text",size:"icon",className:"cursor-pointer",onClick:()=>{var X;return(X=a.current)==null?void 0:X.click()},title:"Attach a file",disabled:l,children:(0,o.jsx)(Pr,{className:"h-3.5 w-3.5"})})}),(0,o.jsx)(ht,{ref:a,type:"file",multiple:!0,hidden:!0,onChange:X=>{X.target.files&&n([...X.target.files])},accept:yo.join(",")})]}),e[18]=a,e[19]=b,e[20]=l,e[21]=n,e[22]=w):w=e[22];let A=l?"Stop":"Submit",z=l?i:s,T=l?!1:r,E;e[23]===l?E=e[24]:(E=l?(0,o.jsx)(xr,{className:"h-3 w-3 fill-current"}):(0,o.jsx)(zr,{className:"h-3 w-3"}),e[23]=l,e[24]=E);let I;e[25]!==z||e[26]!==T||e[27]!==E?(I=(0,o.jsx)(q,{variant:"text",size:"sm",className:"h-6 w-6 p-0 hover:bg-muted/30 cursor-pointer",onClick:z,disabled:T,children:E}),e[25]=z,e[26]=T,e[27]=E,e[28]=I):I=e[28];let Y;e[29]!==A||e[30]!==I?(Y=(0,o.jsx)(me,{content:A,children:I}),e[29]=A,e[30]=I,e[31]=Y):Y=e[31];let W;e[32]!==w||e[33]!==Y||e[34]!==P?(W=(0,o.jsxs)("div",{className:"flex flex-row",children:[P,w,Y]}),e[32]=w,e[33]=Y,e[34]=P,e[35]=W):W=e[35];let M;return e[36]!==W||e[37]!==R?(M=(0,o.jsx)(xt,{children:(0,o.jsxs)("div",{className:"px-3 py-2 border-t border-border/20 flex flex-row items-center justify-between",children:[R,W]})}),e[36]=W,e[37]=R,e[38]=M):M=e[38],M});Ht.displayName="ChatInputFooter";var lt=(0,h.memo)(t=>{let e=(0,pe.c)(29),{placeholder:r,input:s,inputClassName:l,setInput:i,onSubmit:a,inputRef:n,isLoading:c,onStop:d,fileInputRef:m,onAddFiles:p,onClose:u}=t,f;e[0]!==s||e[1]!==a?(f=()=>{s.trim()&&a(void 0,s)},e[0]=s,e[1]=a,e[2]=f):f=e[2];let g=Q(f),j;e[3]===l?j=e[4]:(j=V("px-2 py-3 flex-1",l),e[3]=l,e[4]=j);let b=r||"Type your message...",x;e[5]!==s||e[6]!==n||e[7]!==p||e[8]!==u||e[9]!==a||e[10]!==i||e[11]!==b?(x=(0,o.jsx)(mt,{inputRef:n,value:s,onChange:i,onSubmit:a,onClose:u,onAddFiles:p,placeholder:b}),e[5]=s,e[6]=n,e[7]=p,e[8]=u,e[9]=a,e[10]=i,e[11]=b,e[12]=x):x=e[12];let C;e[13]!==j||e[14]!==x?(C=(0,o.jsx)("div",{className:j,children:x}),e[13]=j,e[14]=x,e[15]=C):C=e[15];let S=!s.trim(),N;e[16]===n?N=e[17]:(N=()=>ar(n),e[16]=n,e[17]=N);let _;e[18]!==m||e[19]!==g||e[20]!==c||e[21]!==p||e[22]!==d||e[23]!==S||e[24]!==N?(_=(0,o.jsx)(Ht,{isEmpty:S,onAddContext:N,onSendClick:g,isLoading:c,onStop:d,fileInputRef:m,onAddFiles:p}),e[18]=m,e[19]=g,e[20]=c,e[21]=p,e[22]=d,e[23]=S,e[24]=N,e[25]=_):_=e[25];let R;return e[26]!==C||e[27]!==_?(R=(0,o.jsxs)("div",{className:"relative shrink-0 min-h-[80px] flex flex-col border-t",children:[C,_]}),e[26]=C,e[27]=_,e[28]=R):R=e[28],R});lt.displayName="ChatInput";var _o=()=>{let t=(0,pe.c)(6),e=$e(er),{handleClick:r}=pt();if(!e){let l;t[0]===r?l=t[1]:(l=(0,o.jsx)(q,{variant:"outline",size:"sm",onClick:()=>r("ai"),children:"Edit AI settings"}),t[0]=r,t[1]=l);let i;t[2]===Symbol.for("react.memo_cache_sentinel")?(i=(0,o.jsx)(Ze,{}),t[2]=i):i=t[2];let a;return t[3]===l?a=t[4]:(a=(0,o.jsx)(Ke,{title:"Chat with AI",description:"AI is currently disabled. Add your API key to enable.",action:l,icon:i}),t[3]=l,t[4]=a),a}let s;return t[5]===Symbol.for("react.memo_cache_sentinel")?(s=(0,o.jsx)(Ro,{}),t[5]=s):s=t[5],s},Ro=()=>{let t=(0,pe.c)(95),e=Xt(ft),[r,s]=qt(Mr),[l,i]=(0,h.useState)(""),[a,n]=(0,h.useState)(""),[c,d]=(0,h.useState)(),m=(0,h.useRef)(null),p=(0,h.useRef)(null),u=(0,h.useRef)(null),f=(0,h.useRef)(null),g=(0,h.useRef)(null),j=tr(),{invokeAiTool:b,sendRun:x}=or(),C=r==null?void 0:r.id,S=Vt(),{addStagedCell:N}=fr(),{createNewCell:_,prepareForRun:R}=Zt(),L;t[0]!==N||t[1]!==_||t[2]!==R||t[3]!==x||t[4]!==S?(L={addStagedCell:N,createNewCell:_,prepareForRun:R,sendRun:x,store:S},t[0]=N,t[1]=_,t[2]=R,t[3]=x,t[4]=S,t[5]=L):L=t[5];let P=L,w;t[6]===(r==null?void 0:r.messages)?w=t[7]:(w=(r==null?void 0:r.messages)||[],t[6]=r==null?void 0:r.messages,t[7]=w);let A;if(t[8]!==j||t[9]!==S){let v;t[11]===S?v=t[12]:(v=async y=>{var ae;let k=await pr(y.messages),H=((ae=S.get(nt))==null?void 0:ae.mode)||Ot;return{body:{tools:cr.getToolSchemas(H),...y,...k}}},t[11]=S,t[12]=v),A=new nr({api:j.getAiURL("chat").toString(),headers:j.headers(),prepareSendMessagesRequest:v}),t[8]=j,t[9]=S,t[10]=A}else A=t[10];let z;t[13]===e?z=t[14]:(z=v=>{let{messages:y}=v;e(k=>$r({chatState:k,chatId:k.activeChatId,messages:y}))},t[13]=e,t[14]=z);let{messages:T,sendMessage:E,error:I,status:Y,regenerate:W,stop:M,addToolResult:ve,id:X}=ir({id:C,sendAutomaticallyWhen:Fo,messages:w,transport:A,onFinish:z,onToolCall:async v=>{let{toolCall:y}=v;if(y.dynamic){B.debug("Skipping dynamic tool call",y);return}await dr({invokeAiTool:b,addToolResult:Ut,toolCall:{toolName:y.toolName,toolCallId:y.toolCallId,input:y.input},toolContext:P})},onError:Oo}),Ut=ve,ge;t[15]===Symbol.for("react.memo_cache_sentinel")?(ge=v=>{if(v.length===0)return;let y=0;for(let k of v)y+=k.size;if(y>So){lr({title:"File size exceeds 50MB limit",description:"Please remove some files and try again."});return}d(k=>[...k??[],...v])},t[15]=ge):ge=t[15];let be=Q(ge),we;t[16]===c?we=t[17]:(we=v=>{c&&d(c.filter(y=>y!==v))},t[16]=c,t[17]=we);let Ue=Q(we),D=Y==="submitted"||Y==="streaming",je;t[18]!==D||t[19]!==T?(je=D&&T.length>0&&ur(T),t[18]=D,t[19]=T,t[20]=je):je=t[20];let ue=je,ye;t[21]===Symbol.for("react.memo_cache_sentinel")?(ye=()=>{requestAnimationFrame(()=>{if(u.current){let v=u.current;v.scrollTop=v.scrollHeight}})},t[21]=ye):ye=t[21];let Se;t[22]===C?Se=t[23]:(Se=[C],t[22]=C,t[23]=Se),(0,h.useEffect)(ye,Se);let Ne;t[24]!==X||t[25]!==E||t[26]!==e?(Ne=async(v,y)=>{let k=Date.now(),H={id:X,title:mr(v),messages:[],createdAt:k,updatedAt:k};e(fe=>{let it=new Map(fe.chats);return it.set(H.id,H),{...fe,chats:it,activeChatId:H.id}});let ae=y&&y.length>0?await dt(y):void 0;E({role:"user",parts:[{type:"text",text:v},...ae??[]]}),d(void 0),i("")},t[24]=X,t[25]=E,t[26]=e,t[27]=Ne):Ne=t[27];let Ye=Ne,Ce;t[28]===s?Ce=t[29]:(Ce=()=>{s(null),i(""),n(""),d(void 0)},t[28]=s,t[29]=Ce);let Xe=Q(Ce),_e;t[30]!==T||t[31]!==E?(_e=(v,y)=>{var fe;let k=T[v],H=(fe=k.parts)==null?void 0:fe.filter(Wo),ae=k.id;E({messageId:ae,role:"user",parts:[{type:"text",text:y},...H]})},t[30]=T,t[31]=E,t[32]=_e):_e=t[32];let he=Q(_e),Re;t[33]!==c||t[34]!==E?(Re=async(v,y)=>{var H;if(!y.trim())return;(H=p.current)!=null&&H.view&&ct(p.current.view);let k=c?await dt(c):void 0;v==null||v.preventDefault(),E({text:y,files:k}),i(""),d(void 0)},t[33]=c,t[34]=E,t[35]=Re):Re=t[35];let qe=Q(Re),Te;t[36]===W?Te=t[37]:(Te=()=>{W()},t[36]=W,t[37]=Te);let Ve=Te,Ae;t[38]!==Ye||t[39]!==c||t[40]!==a?(Ae=()=>{var v;a.trim()&&((v=m.current)!=null&&v.view&&ct(m.current.view),Ye(a.trim(),c))},t[38]=Ye,t[39]=c,t[40]=a,t[41]=Ae):Ae=t[41];let Be=Q(Ae),Ee;t[42]===Symbol.for("react.memo_cache_sentinel")?(Ee=()=>{var v,y;return(y=(v=m.current)==null?void 0:v.editor)==null?void 0:y.blur()},t[42]=Ee):Ee=t[42];let Yt=Ee,F=T.length===0,Le;t[43]!==qe||t[44]!==Be||t[45]!==l||t[46]!==D||t[47]!==F||t[48]!==a||t[49]!==be||t[50]!==M?(Le=F?(0,o.jsx)(lt,{placeholder:"Ask anything, @ to include context about tables or dataframes",input:a,inputRef:m,inputClassName:"px-1 py-0",setInput:n,onSubmit:Be,isLoading:D,onStop:M,fileInputRef:f,onAddFiles:be,onClose:Yt},"new-thread-input"):(0,o.jsx)(lt,{input:l,setInput:i,onSubmit:qe,inputRef:p,isLoading:D,onStop:M,onClose:()=>{var v,y;return(y=(v=p.current)==null?void 0:v.editor)==null?void 0:y.blur()},fileInputRef:f,onAddFiles:be}),t[43]=qe,t[44]=Be,t[45]=l,t[46]=D,t[47]=F,t[48]=a,t[49]=be,t[50]=M,t[51]=Le):Le=t[51];let Z=Le,Pe;t[52]!==c||t[53]!==F||t[54]!==Ue?(Pe=c&&c.length>0&&(0,o.jsx)("div",{className:V("flex flex-row gap-1 flex-wrap p-1",F&&"py-2 px-1"),children:c==null?void 0:c.map(v=>(0,o.jsx)(Br,{file:v,onRemove:()=>Ue(v)},v.name))}),t[52]=c,t[53]=F,t[54]=Ue,t[55]=Pe):Pe=t[55];let G=Pe,Je=r==null?void 0:r.id,K;t[56]!==Xe||t[57]!==s||t[58]!==Je?(K=(0,o.jsx)(xt,{children:(0,o.jsx)(No,{onNewChat:Xe,activeChatId:Je,setActiveChat:s})}),t[56]=Xe,t[57]=s,t[58]=Je,t[59]=K):K=t[59];let ee;t[60]!==Z||t[61]!==G||t[62]!==F?(ee=F&&(0,o.jsxs)("div",{className:"rounded-md border bg-background",children:[G,Z]}),t[60]=Z,t[61]=G,t[62]=F,t[63]=ee):ee=t[63];let te;if(t[64]!==he||t[65]!==ue||t[66]!==T){let v;t[68]!==he||t[69]!==ue||t[70]!==T.length?(v=(y,k)=>(0,o.jsx)(Wt,{message:y,index:k,onEdit:he,isStreamingReasoning:ue,isLast:k===T.length-1},y.id),t[68]=he,t[69]=ue,t[70]=T.length,t[71]=v):v=t[71],te=T.map(v),t[64]=he,t[65]=ue,t[66]=T,t[67]=te}else te=t[67];let re;t[72]===D?re=t[73]:(re=D&&(0,o.jsx)("div",{className:"flex justify-center py-4",children:(0,o.jsx)(ut,{className:"h-4 w-4 animate-spin"})}),t[72]=D,t[73]=re);let oe;t[74]!==I||t[75]!==Ve?(oe=I&&(0,o.jsxs)("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[(0,o.jsx)(Ur,{error:I}),(0,o.jsx)(q,{variant:"outline",size:"sm",onClick:Ve,children:"Retry"})]}),t[74]=I,t[75]=Ve,t[76]=oe):oe=t[76];let ze;t[77]===Symbol.for("react.memo_cache_sentinel")?(ze=(0,o.jsx)("div",{ref:g}),t[77]=ze):ze=t[77];let le;t[78]!==ee||t[79]!==te||t[80]!==re||t[81]!==oe?(le=(0,o.jsxs)("div",{className:"flex-1 px-3 bg-(--slate-1) gap-4 py-3 flex flex-col overflow-y-auto",ref:u,children:[ee,te,re,oe,ze]}),t[78]=ee,t[79]=te,t[80]=re,t[81]=oe,t[82]=le):le=t[82];let ie;t[83]!==D||t[84]!==M?(ie=D&&(0,o.jsx)("div",{className:"w-full flex justify-center items-center z-20 border-t",children:(0,o.jsx)(q,{variant:"linkDestructive",size:"sm",onClick:M,children:"Stop"})}),t[83]=D,t[84]=M,t[85]=ie):ie=t[85];let se;t[86]!==Z||t[87]!==G||t[88]!==F?(se=!F&&(0,o.jsxs)(o.Fragment,{children:[G,Z]}),t[86]=Z,t[87]=G,t[88]=F,t[89]=se):se=t[89];let ke;return t[90]!==K||t[91]!==le||t[92]!==ie||t[93]!==se?(ke=(0,o.jsxs)("div",{className:"flex flex-col h-[calc(100%-53px)]",children:[K,le,ie,se]}),t[90]=K,t[91]=le,t[92]=ie,t[93]=se,t[94]=ke):ke=t[94],ke},To=_o;function Ao(t){return t.type==="text"}function Eo(t){return t.text}function Lo(t){return t.type==="file"}function Po(t,e){return(0,o.jsx)(Jr,{attachment:t},e)}function zo(){}function ko(){}function Io(t){return t.type==="text"}function Do(t){return t.text}function Mo(t){return(0,o.jsx)(yr,{value:t.value,className:"text-xs",children:(0,o.jsxs)("div",{className:"flex flex-col",children:[t.label,(0,o.jsx)("div",{className:"text-muted-foreground text-xs pt-1 block",children:t.subtitle})]})},t.value)}function Fo(t){let{messages:e}=t;return hr(e)}function Oo(t){B.error("An error occurred:",t)}function Wo(t){return t.type==="file"}export{To as default};
